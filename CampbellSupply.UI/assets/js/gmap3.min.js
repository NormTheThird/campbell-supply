/*!
 *  GMAP3 Plugin for JQuery
 *  Version   : 5.0b
 *  Date      : 2012-11-17
 *  Licence   : GPL v3 : http://www.gnu.org/licenses/gpl.html
 *  Author    : DEMONTE Jean-Baptiste
 *  Contact   : jbdemonte@gmail.com
 *  Web site  : http://gmap3.net
 */
(function(n,t){function d(){r||(r={verbose:!1,queryLimit:{attempt:5,delay:250,random:250},classes:{Map:google.maps.Map,Marker:google.maps.Marker,InfoWindow:google.maps.InfoWindow,Circle:google.maps.Circle,Rectangle:google.maps.Rectangle,OverlayView:google.maps.OverlayView,StreetViewPanorama:google.maps.StreetViewPanorama,KmlLayer:google.maps.KmlLayer,TrafficLayer:google.maps.TrafficLayer,BicyclingLayer:google.maps.BicyclingLayer,GroundOverlay:google.maps.GroundOverlay,StyledMapType:google.maps.StyledMapType,ImageMapType:google.maps.ImageMapType},map:{mapTypeId:google.maps.MapTypeId.ROADMAP,center:[46.578498,2.457275],zoom:2},overlay:{pane:"floatPane",content:"",offset:{x:0,y:0}},geoloc:{getCurrentPosition:{maximumAge:6e4,timeout:5e3}}})}function s(n,i){return n!==t?n:"gmap3_"+(i?a+1:++a)}function f(t,i,r,u,f){if(i.todo.events||i.todo.onces)var e={id:u,data:i.todo.data,tag:i.todo.tag};i.todo.events&&n.each(i.todo.events,function(n,i){google.maps.event.addListener(r,n,function(n){i.apply(t,[f?f:r,n,e])})});i.todo.onces&&n.each(i.todo.onces,function(n,i){google.maps.event.addListenerOnce(r,n,function(n){i.apply(t,[f?f:r,n,e])})})}function g(){var n=[];this.empty=function(){return!n.length};this.add=function(t){n.push(t)};this.get=function(){return n.length?n[0]:!1};this.ack=function(){n.shift()}}function nt(t,i,u){function h(n){var t={};return t[n]={},t}function c(){for(var n in u)if(!(n in f))return n}var f={},o=this,s,e={latLng:{map:!1,marker:!1,infowindow:!1,circle:!1,overlay:!1,getlatlng:!1,getmaxzoom:!1,getelevation:!1,streetviewpanorama:!1,getaddress:!0},geoloc:{getgeoloc:!0}};typeof u=="string"&&(u=h(u));this.run=function(){for(var o,h;o=c();){if(typeof t[o]=="function"){s=o;h=n.extend(!0,{},r[o]||{},u[o].options||{});o in e.latLng?u[o].values?ct(u[o].values,t,t[o],{todo:u[o],opts:h,session:f}):l(t,t[o],e.latLng[o],{todo:u[o],opts:h,session:f}):o in e.geoloc?lt(t,t[o],{todo:u[o],opts:h,session:f}):t[o].apply(t,[{todo:u[o],opts:h,session:f}]);return}f[o]=null}i.apply(t,[u,f])};this.ack=function(n){f[s]=n;o.run.apply(o,[])}}function v(n){var t,i=[];for(t in n)i.push(t);return i}function o(t,i){var u={},r,f,e;if(t.todo)for(r in t.todo)r!=="options"&&r!=="values"&&(u[r]=t.todo[r]);for(e=["data","tag","id","events","onces"],f=0;f<e.length;f++)tt(u,e[f],i,t.todo);return u.options=n.extend({},t.todo.options||{},i.options||{}),u}function tt(n,t){for(var i=2;i<arguments.length;i++)if(t in arguments[i]){n[t]=arguments[i][t];return}}function it(){var n=[];this.get=function(t){if(n.length)for(var e,i,r,u,o=v(t),f=0;f<n.length;f++){for(r=n[f],u=o.length==r.keys.length,e=0;e<o.length&&u;e++)i=o[e],u=i in r.request,u&&(u=typeof t[i]=="object"&&"equals"in t[i]&&typeof t[i]=="function"?t[i].equals(r.request[i]):t[i]===r.request[i]);if(u)return r.results}};this.store=function(t,i){n.push({request:t,keys:v(t),results:i})}}function y(t,i,u,f){var o=this,e=[];r.classes.OverlayView.call(this);this.setMap(t);this.onAdd=function(){var t=this.getPanes();i.pane in t&&n(t[i.pane]).append(f);n.each("dblclick click mouseover mousemove mouseout mouseup mousedown".split(" "),function(t,i){e.push(google.maps.event.addDomListener(f[0],i,function(t){n.Event(t).stopPropagation();google.maps.event.trigger(o,i,[t])}))});e.push(google.maps.event.addDomListener(f[0],"contextmenu",function(t){n.Event(t).stopPropagation();google.maps.event.trigger(o,"rightclick",[t])}));this.draw()};this.getPosition=function(){return u};this.draw=function(){this.draw=function(){var n=this.getProjection().fromLatLngToDivPixel(u);f.css("left",n.x+i.offset.x+"px").css("top",n.y+i.offset.y+"px")}};this.onRemove=function(){for(var n=0;n<e.length;n++)google.maps.event.removeListener(e[n]);f.remove()};this.hide=function(){f.hide()};this.show=function(){f.show()};this.toggle=function(){f&&(f.is(":visible")?this.show():this.hide())};this.toggleDOM=function(){this.getMap()?this.setMap(null):this.setMap(t)};this.getDOMElement=function(){return f[0]}}function rt(n){function t(){return this.onAdd=function(){},this.onRemove=function(){},this.draw=function(){},r.classes.OverlayView.apply(this,[])}t.prototype=r.classes.OverlayView.prototype;var i=new t;return i.setMap(n),i}function ut(i,r,u,e){function ut(){if(p=ht.getProjection(),!p){setTimeout(function(){ut.apply(st,[])},25);return}nt=!0;y.push(google.maps.event.addListener(r,"zoom_changed",function(){et()}));y.push(google.maps.event.addListener(r,"bounds_changed",function(){et()}));w()}function ft(n){typeof h[n]=="object"?(typeof h[n].obj.setMap=="function"&&h[n].obj.setMap(null),typeof h[n].obj.remove=="function"&&h[n].obj.remove(),typeof h[n].shadow.remove=="function"&&h[n].obj.remove(),typeof h[n].shadow.setMap=="function"&&h[n].shadow.setMap(null),delete h[n].obj,delete h[n].shadow):o[n]&&o[n].setMap(null);delete h[n]}function lt(){var u,n,f,t,i,e,r,o;return arguments[0]instanceof google.maps.LatLng?(u=arguments[0].lat(),f=arguments[0].lng(),arguments[1]instanceof google.maps.LatLng?(n=arguments[1].lat(),t=arguments[1].lng()):(n=arguments[1],t=arguments[2])):(u=arguments[0],f=arguments[1],arguments[2]instanceof google.maps.LatLng?(n=arguments[2].lat(),t=arguments[2].lng()):(n=arguments[2],t=arguments[3])),i=Math.PI*u/180,e=Math.PI*f/180,r=Math.PI*n/180,o=Math.PI*t/180,6371e3*Math.acos(Math.min(Math.cos(i)*Math.cos(r)*Math.cos(e)*Math.cos(o)+Math.cos(i)*Math.sin(e)*Math.cos(r)*Math.sin(o)+Math.sin(i)*Math.sin(r),1))}function at(){var n=lt(r.getCenter(),r.getBounds().getNorthEast()),t=new google.maps.Circle({center:r.getCenter(),radius:1.25*n});return t.getBounds()}function vt(){var n={};for(var t in h)n[t]=!0;return n}function et(){clearTimeout(tt);tt=setTimeout(function(){w()},25)}function ot(n){var t=p.fromLatLngToDivPixel(n),i=p.fromDivPixelToLatLng(new google.maps.Point(t.x+u,t.y-u)),r=p.fromDivPixelToLatLng(new google.maps.Point(t.x-u,t.y+u));return new google.maps.LatLngBounds(r,i)}function w(){if(!b&&!g&&nt){var u=[],w={},et=r.getZoom(),ht=e!==t&&et>e,ut=vt(),a,f,o,tt,rt,i,y,st=!1,p,s;for(v=!1,et>3&&(p=at(),st=p.getSouthWest().lng()<p.getNorthEast().lng()),n.each(c,function(n,t){t&&(!st||p.contains(t.options.position))&&(!d||d(l[n]))&&u.push(n)});;){for(a=0;w[a]&&a<u.length;)a++;if(a==u.length)break;if(i=[],k&&!ht){do{if(y=i,i=[],y.length){for(tt=rt=0,o=0;o<y.length;o++)tt+=c[u[y[o]]].options.position.lat(),rt+=c[u[y[o]]].options.position.lng();tt/=y.length;rt/=y.length;p=ot(new google.maps.LatLng(tt,rt))}else p=ot(c[u[a]].options.position);for(f=a;f<u.length;f++)w[f]||p.contains(c[u[f]].options.position)&&i.push(f)}while(y.length<i.length&&i.length>1)}else for(f=a;f<u.length;f++)if(!w[f]){i.push(f);break}for(s={latLng:p.getCenter(),indexes:[],ref:[]},o=0;o<i.length;o++)w[i[o]]=!0,s.indexes.push(u[i[o]]),s.ref.push(u[i[o]]);s.ref=s.ref.join("-");s.ref in ut?delete ut[s.ref]:(i.length===1&&(h[s.ref]=!0),function(n){setTimeout(function(){it(n)},1)}(s))}n.each(ut,function(n){ft(n)});g=!1}}var b=!1,v=!1,g=!1,nt=!1,k=!0,st=this,y=[],h={},a={},o=[],c=[],l=[],ht=rt(r),tt,p,d,it,ct;ut();this.getById=function(n){return n in a?o[a[n]]:!1};this.clearById=function(n){if(n in a){var t=a[n];o[t]&&o[t].setMap(null);delete o[t];o[t]=!1;delete c[t];c[t]=!1;delete l[t];l[t]=!1;delete a[n];v=!0}};this.add=function(n,t){n.id=s(n.id);this.clearById(n.id);a[n.id]=o.length;o.push(null);c.push(n);l.push(t);v=!0};this.addMarker=function(n,t){t=t||{};t.id=s(t.id);this.clearById(t.id);t.options||(t.options={});t.options.position=n.getPosition();f(i,{todo:t},n,t.id);a[t.id]=o.length;o.push(n);c.push(t);l.push(t.data||{});v=!0};this.todo=function(n){return c[n]};this.value=function(n){return l[n]};this.marker=function(n){return o[n]};this.setMarker=function(n,t){o[n]=t};this.store=function(n,t,i){h[n.ref]={obj:t,shadow:i}};this.free=function(){for(var t=0;t<y.length;t++)google.maps.event.removeListener(y[t]);y=[];n.each(h,function(n){ft(n)});h={};n.each(c,function(n){c[n]=null});c=[];n.each(o,function(n){o[n]&&(o[n].setMap(null),delete o[n])});o=[];n.each(l,function(n){delete l[n]});l=[];a={}};this.filter=function(n){d=n;w()};this.enable=function(n){k!=n&&(k=n,w())};this.display=function(n){it=n};this.error=function(n){ct=n};this.beginUpdate=function(){b=!0};this.endUpdate=function(){b=!1;v&&w()}}function p(n,t){this.id=function(){return n};this.filter=function(n){t.filter(n)};this.enable=function(){t.enable(!0)};this.disable=function(){t.enable(!1)};this.add=function(n,i,r){r||t.beginUpdate();t.addMarker(n,i);r||t.endUpdate()};this.getById=function(n){return t.getById(n)};this.clearById=function(n,i){i||t.beginUpdate();t.clearById(n);i||t.endUpdate()}}function ft(){function u(i){if(i)return typeof i=="function"?i:(i=e(i),function(r){if(r===t)return!1;if(typeof r=="object"){for(var u=0;u<r.length;u++)if(n.inArray(r[u],i)>=0)return!0;return!1}return n.inArray(r,i)>=0})}function f(n){return{id:n.id,name:n.name,object:n.obj,tag:n.tag,data:n.data}}function o(n){typeof n.setMap=="function"&&n.setMap(null);typeof n.remove=="function"&&n.remove();typeof n.free=="function"&&n.free();n=null}var i={},r={};this.add=function(n,t,u,f){var o=n.todo||{},e=s(o.id);return i[t]||(i[t]=[]),e in r&&this.clearById(e),r[e]={obj:u,sub:f,name:t,id:e,tag:o.tag,data:o.data},i[t].push(e),e};this.getById=function(n,t,i){return n in r?t?r[n].sub:i?f(r[n]):r[n].obj:!1};this.get=function(n,t,e,o){var h,s,c=u(e);if(!i[n]||!i[n].length)return null;for(h=i[n].length;h;)if(h--,s=i[n][t?h:i[n].length-h-1],s&&r[s]){if(c&&!c(r[s].tag))continue;return o?f(r[s]):r[s].obj}return null};this.all=function(n,e,o){var s=[],h=u(e),c=function(n){for(var t,u=0;u<i[n].length;u++)if(t=i[n][u],t&&r[t]){if(h&&!h(r[t].tag))continue;s.push(o?f(r[t]):r[t].obj)}};if(n in i)c(n);else if(n===t)for(n in i)c(n);return s};this.rm=function(n,t,u){var f,e;if(!i[n])return!1;if(t){if(u){for(f=i[n].length-1;f>=0;f--)if(e=i[n][f],t(r[e].tag))break}else for(f=0;f<i[n].length;f++)if(e=i[n][f],t(r[e].tag))break}else f=u?i[n].length-1:0;return(f in i[n])?this.clearById(i[n][f],f):!1};this.clearById=function(n,u){if(n in r){for(var e=r[n].name,f=0;u===t&&f<i[e].length;f++)n===i[e][f]&&(u=f);return o(r[n].obj),r[n].sub&&o(r[n].sub),delete r[n],i[e].splice(u,1),!0}return!1};this.objGetById=function(n){var t,u;if(i.clusterer)for(u in i.clusterer)if((t=r[i.clusterer[u]].obj.getById(n))!==!1)return t;return!1};this.objClearById=function(n){if(i.clusterer)for(var t in i.clusterer)if(r[i.clusterer[t]].obj.clearById(n))return!0;return null};this.clear=function(n,t,r,f){var c,o,s,h=u(f);if(n&&n.length)n=e(n);else{n=[];for(c in i)n.push(c)}for(o=0;o<n.length;o++)if(n[o]){if(s=n[o],!i[s])continue;if(t)this.rm(s,h,!0);else if(r)this.rm(s,h,!1);else while(this.rm(s,h,!1));}}}function et(){return u.geocoder||(u.geocoder=new google.maps.Geocoder),u.geocoder}function ot(){return u.directionsService||(u.directionsService=new google.maps.DirectionsService),u.directionsService}function b(){return u.elevationService||(u.elevationService=new google.maps.ElevationService),u.elevationService}function st(){return u.maxZoomService||(u.maxZoomService=new google.maps.MaxZoomService),u.maxZoomService}function ht(){return u.distanceMatrixService||(u.distanceMatrixService=new google.maps.DistanceMatrixService),u.distanceMatrixService}function k(){if(r.verbose){var n,t=[];if(window.console&&typeof console.error=="function"){for(n=0;n<arguments.length;n++)t.push(arguments[n]);console.error.apply(console,t)}else{for(t="",n=0;n<arguments.length;n++)t+=arguments[n].toString()+" ";alert(t)}}}function c(n){return(typeof n=="number"||typeof n=="string")&&n!==""&&!isNaN(n)}function e(n){var r,i=[];if(n!==t)if(typeof n=="object")if(typeof n.length=="number")i=n;else for(r in n)i.push(n[r]);else i.push(n);return i}function i(t,r,u){var f=r?t:null;return!t||typeof t=="string"?f:t.latLng?i(t.latLng):t instanceof google.maps.LatLng?t:c(t.lat)?new google.maps.LatLng(t.lat,t.lng):!u&&n.isArray(t)?!c(t[0])||!c(t[1])?f:new google.maps.LatLng(t[0],t[1]):f}function h(t){var r,u;return!t||t instanceof google.maps.LatLngBounds?t||null:(n.isArray(t)?t.length==2?(r=i(t[0]),u=i(t[1])):t.length==4&&(r=i([t[0],t[1]]),u=i([t[2],t[3]])):"ne"in t&&"sw"in t?(r=i(t.ne),u=i(t.sw)):"n"in t&&"e"in t&&"s"in t&&"w"in t&&(r=i([t.n,t.e]),u=i([t.s,t.w])),r&&u)?new google.maps.LatLngBounds(u,r):null}function l(n,t,u,f,e){var c=u?i(f.todo,!1,!0):!1,o=c?{latLng:c}:f.todo.address?typeof f.todo.address=="string"?{address:f.todo.address}:f.todo.address:!1,s=o?w.get(o):!1,a=this;o?(e=e||0,s?(f.latLng=s.results[0].geometry.location,f.results=s.results,f.status=s.status,t.apply(n,[f])):(o.location&&(o.location=i(o.location)),o.bounds&&(o.bounds=h(o.bounds)),et().geocode(o,function(i,s){s===google.maps.GeocoderStatus.OK?(w.store(o,{results:i,status:s}),f.latLng=i[0].geometry.location,f.results=i,f.status=s,t.apply(n,[f])):s===google.maps.GeocoderStatus.OVER_QUERY_LIMIT&&e<r.queryLimit.attempt?setTimeout(function(){l.apply(a,[n,t,u,f,e+1])},r.queryLimit.delay+Math.floor(Math.random()*r.queryLimit.random)):(k("geocode failed",s,o),f.latLng=f.results=!1,f.status=s,t.apply(n,[f]))}))):(f.latLng=i(f.todo,!1,!0),t.apply(n,[f]))}function ct(t,i,r,u){function o(){do f++;while(f<t.length&&!("address"in t[f]));if(f>=t.length){r.apply(i,[u]);return}l(e,function(i){delete i.todo;n.extend(t[f],i);o.apply(e,[])},!0,{todo:t[f]})}var e=this,f=-1;o()}function lt(n,t,i){var r=!1;navigator&&navigator.geolocation?navigator.geolocation.getCurrentPosition(function(u){r||(r=!0,i.latLng=new google.maps.LatLng(u.coords.latitude,u.coords.longitude),t.apply(n,[i]))},function(){r||(r=!0,i.latLng=!1,t.apply(n,[i]))},i.opts.getCurrentPosition):(i.latLng=!1,t.apply(n,[i]))}function at(u){function rt(){!v&&(v=it.get())&&v.run()}function ct(){v=null;it.ack();rt.call(tt)}function d(t){for(var r=[],i=1;i<arguments.length;i++)r.push(arguments[i]);typeof t.todo.callback=="function"?t.todo.callback.apply(u,r):typeof t.todo.callback=="object"&&n.each(t.todo.callback,function(n,t){typeof t=="function"&&t.apply(u,r)})}function a(n,t,i){i&&f(u,n,t,i);d(n,t);v.ack(t)}function w(t,f){if(f=f||{},c)f.todo&&f.todo.options&&c.setOptions(f.todo.options);else{var e=f.opts||n.extend(!0,{},r.map,f.todo&&f.todo.options?f.todo.options:{});e.center=t||i(e.center);c=new r.classes.Map(u.get(0),e)}}function et(t,r,e){var s=[],h="values"in t.todo;if(h||(t.todo.values=[{options:t.opts}]),!t.todo.values.length){a(t,!1);return}w();n.each(t.todo.values,function(h,a){var b,y,p,w,v=o(t,a);if(v.options[e])if(v.options[e][0][0]&&n.isArray(v.options[e][0][0]))for(y=0;y<v.options[e].length;y++)for(p=0;p<v.options[e][y].length;p++)v.options[e][y][p]=i(v.options[e][y][p]);else for(y=0;y<v.options[e].length;y++)v.options[e][y]=i(v.options[e][y]);v.options.map=c;w=new google.maps[r](v.options);s.push(w);b=l.add({todo:v},r.toLowerCase(),w);f(u,{todo:v},w,b)});a(t,h?s:s[0])}function lt(e){var o=new ut(u,c,e.radius,e.maxZoom),h={},l={},a;for(var s in e)/^[0-9]+$/.test(s)?(l[s]=e[s],l[s].width=l[s].width||0,l[s].height=l[s].height||0):h[s]=e[s];return a=h.calculator?function(t){var i=[];return n.each(t,function(n,t){i.push(o.value(t))}),h.calculator.apply(u,[i])}:function(n){return n.length},o.error(function(){k.apply(tt,arguments)}),o.display(function(e){var p,s,w=0,v,b,y,k=a(e.indexes);if(k>1){for(p in l)p=1*p,p>w&&p<=k&&(w=p);s=l[w]}s?(y=s.offset||[-s.width/2,-s.height/2],v=n.extend({},h),v.options=n.extend({pane:"overlayLayer",content:s.content?s.content.replace("CLUSTER_COUNT",k):"",offset:{x:("x"in y?y.x:y[0])||0,y:("y"in y?y.y:y[1])||0}},h.options||{}),b=tt.overlay({todo:v,opts:v.options,latLng:i(e)},!0),v.options.pane="floatShadow",v.options.content=n(document.createElement("div")).width(s.width+"px").height(s.height+"px"),shadow=tt.overlay({todo:v,opts:v.options,latLng:i(e)},!0),h.data={latLng:i(e),markers:[]},n.each(e.indexes,function(n,t){h.data.markers.push(o.value(t));o.marker(t)&&o.marker(t).setMap(null)}),f(u,{todo:h},shadow,t,{main:b,shadow:shadow}),o.store(e,b,shadow)):n.each(e.indexes,function(n,t){if(o.marker(t))o.marker(t).setMap(c);else{var i=o.todo(t),e=new r.classes.Marker(i.options);o.setMarker(t,e);f(u,{todo:i},e,i.id)}})}),o}var tt=this,it=new g,l=new ft,c=null,v;this._plan=function(n){for(var t=0;t<n.length;t++)it.add(new nt(tt,ct,n[t]));rt()};this.map=function(n){w(n.latLng,n);f(u,n,c);a(n,c)};this.destroy=function(n){l.clear();u.empty();c&&(c=null);a(n,!0)};this.infowindow=function(e){var s=[],h="values"in e.todo;h||(e.latLng?e.opts.position=e.latLng:e.opts.position&&(e.opts.position=i(e.opts.position)),e.todo.values=[{options:e.opts}]);n.each(e.todo.values,function(n,i){var y,v,a=o(e,i);c||w(a.options.position);v=new r.classes.InfoWindow(a.options);v&&(a.open===t||a.open)&&(h?v.open(c,a.anchor?a.anchor:t):v.open(c,a.anchor?a.anchor:e.latLng?t:e.session.marker?e.session.marker:t));s.push(v);y=l.add({todo:a},"infowindow",v);f(u,{todo:a},v,y)});a(e,h?s:s[0])};this.circle=function(t){var e=[],s="values"in t.todo;if(s||(t.opts.center=t.latLng||i(t.opts.center),t.todo.values=[{options:t.opts}]),!t.todo.values.length){a(t,!1);return}n.each(t.todo.values,function(n,s){var v,a,h=o(t,s);h.options.center=h.options.center?i(h.options.center):i(s);c||w(h.options.center);h.options.map=c;a=new r.classes.Circle(h.options);e.push(a);v=l.add({todo:h},"circle",a);f(u,{todo:h},a,v)});a(t,s?e:e[0])};this.overlay=function(t,i){var e,u,f=n(document.createElement("div")).css("border","none").css("borderWidth","0px").css("position","absolute");if(f.append(t.opts.content),y.prototype=new r.classes.OverlayView,u=new y(c,t.opts,t.latLng,f),f=null,i)return u;e=l.add(t,"overlay",u);a(t,u,e)};this.getaddress=function(n){d(n,n.results,n.status);v.ack()};this.getlatlng=function(n){d(n,n.results,n.status);v.ack()};this.getmaxzoom=function(n){st().getMaxZoomAtLatLng(n.latLng,function(t){d(n,t.status===google.maps.MaxZoomStatus.OK?t.zoom:!1,status);v.ack()})};this.getelevation=function(n){var r,t=[],u=function(t,i){d(n,i===google.maps.ElevationStatus.OK?t:!1,i);v.ack()};if(n.latLng)t.push(n.latLng);else for(t=e(n.todo.locations||[]),r=0;r<t.length;r++)t[r]=i(t[r]);if(t.length)b().getElevationForLocations({locations:t},u);else{if(n.todo.path&&n.todo.path.length)for(r=0;r<n.todo.path.length;r++)t.push(i(n.todo.path[r]));t.length?b().getElevationAlongPath({path:t,samples:n.todo.samples},u):v.ack()}};this.defaults=function(t){n.each(t.todo,function(t,i){r[t]=typeof r[t]=="object"?n.extend({},r[t],i):i});v.ack(!0)};this.rectangle=function(t){var i=[],e="values"in t.todo;if(e||(t.todo.values=[{options:t.opts}]),!t.todo.values.length){a(t,!1);return}n.each(t.todo.values,function(n,e){var v,a,s=o(t,e);s.options.bounds=s.options.bounds?h(s.options.bounds):h(e);c||w(s.options.bounds.getCenter());s.options.map=c;a=new r.classes.Rectangle(s.options);i.push(a);v=l.add({todo:s},"rectangle",a);f(u,{todo:s},a,v)});a(t,e?i:i[0])};this.polyline=function(n){et(n,"Polyline","path")};this.polygon=function(n){et(n,"Polygon","paths")};this.trafficlayer=function(n){w();var t=l.get("trafficlayer");t||(t=new r.classes.TrafficLayer,t.setMap(c),l.add(n,"trafficlayer",t));a(n,t)};this.bicyclinglayer=function(n){w();var t=l.get("bicyclinglayer");t||(t=new r.classes.BicyclingLayer,t.setMap(c),l.add(n,"bicyclinglayer",t));a(n,t)};this.groundoverlay=function(n){n.opts.bounds=h(n.opts.bounds);n.opts.bounds&&w(n.opts.bounds.getCenter());var i,t=new r.classes.GroundOverlay(n.opts.url,n.opts.bounds,n.opts.opts);t.setMap(c);i=l.add(n,"groundoverlay",t);a(n,t,i)};this.streetviewpanorama=function(t){t.opts.opts||(t.opts.opts={});t.latLng?t.opts.opts.position=t.latLng:t.opts.opts.position&&(t.opts.opts.position=i(t.opts.opts.position));t.todo.divId?t.opts.container=document.getElementById(t.todo.divId):t.opts.container&&(t.opts.container=n(t.opts.container).get(0));var f,u=new r.classes.StreetViewPanorama(t.opts.container,t.opts.opts);u&&c.setStreetView(u);f=l.add(t,"streetviewpanorama",u);a(t,u,f)};this.kmllayer=function(t){var i=[],e="values"in t.todo;if(e||(t.todo.values=[{options:t.opts}]),!t.todo.values.length){a(t,!1);return}n.each(t.todo.values,function(n,e){var a,h,s=o(t,e);c||w();s.options.opts.map=c;h=new r.classes.KmlLayer(s.options.url,s.options.opts);i.push(h);a=l.add({todo:s},"kmllayer",h);f(u,{todo:s},h,a)});a(t,e?i:i[0])};this.panel=function(i){w();var s,e=0,o=0,r,f=n(document.createElement("div"));f.css("position","absolute").css("z-index","1000");i.opts.content&&(r=n(i.opts.content),i.opts.left!==t?e=i.opts.left:i.opts.right!==t?e=u.width()-r.width()-i.opts.right:i.opts.center&&(e=(u.width()-r.width())/2),i.opts.top!==t?o=i.opts.top:i.opts.bottom!==t?o=u.height()-r.height()-i.opts.bottom:i.opts.middle&&(o=(u.height()-r.height())/2),f.css("top",o+"px").css("left",e+"px").append(r));u.first().prepend(f);s=l.add(i,"panel",f);a(i,f,s);f=null};this.marker=function(t){var b="values"in t.todo,h=!c,v,e,y;if(b||(t.opts.position=t.latLng||i(t.opts.position),t.todo.values=[{options:t.opts}]),!t.todo.values.length){a(t,!1);return}if(h&&w(),t.todo.cluster&&!c.getBounds()){google.maps.event.addListenerOnce(c,"bounds_changed",function(){tt.marker.apply(tt,[t])});return}t.todo.cluster?(t.todo.cluster instanceof p?(v=t.todo.cluster,e=l.getById(v.id(),!0)):(e=lt(t.todo.cluster),v=new p(s(t.todo.id,!0),e),l.add(t,"clusterer",v,e)),e.beginUpdate(),n.each(t.todo.values,function(n,r){var u=o(t,r);u.options.position=u.options.position?i(u.options.position):i(r);u.options.map=c;h&&(c.setCenter(u.options.position),h=!1);e.add(u,r)}),e.endUpdate(),a(t,v)):(y=[],n.each(t.todo.values,function(n,e){var v,a,s=o(t,e);s.options.position=s.options.position?i(s.options.position):i(e);s.options.map=c;h&&(c.setCenter(s.options.position),h=!1);a=new r.classes.Marker(s.options);y.push(a);v=l.add({todo:s},"marker",a);f(u,{todo:s},a,v)}),a(t,b?y:y[0]))};this.getroute=function(n){n.opts.origin=i(n.opts.origin,!0);n.opts.destination=i(n.opts.destination,!0);ot().route(n.opts,function(t,i){d(n,i==google.maps.DirectionsStatus.OK?t:!1,i);v.ack()})};this.directionsrenderer=function(t){t.opts.map=c;var r,i=new google.maps.DirectionsRenderer(t.opts);t.todo.divId?i.setPanel(document.getElementById(t.todo.divId)):t.todo.container&&i.setPanel(n(t.todo.container).get(0));r=l.add(t,"directionrenderer",i);a(t,i,r)};this.getgeoloc=function(n){a(n,n.latLng)};this.styledmaptype=function(n){w();var t=new r.classes.StyledMapType(n.todo.styles,n.opts);c.mapTypes.set(n.todo.id,t);a(n,t)};this.imagemaptype=function(n){w();var t=new r.classes.ImageMapType(n.opts);c.mapTypes.set(n.todo.id,t);a(n,t)};this.autofit=function(t){var i=new google.maps.LatLngBounds;n.each(l.all(),function(n,t){t.getPosition?i.extend(t.getPosition()):t.getBounds?(i.extend(t.getBounds().getNorthEast()),i.extend(t.getBounds().getSouthWest())):t.getPaths?t.getPaths().forEach(function(n){n.forEach(function(n){i.extend(n)})}):t.getPath?t.getPath().forEach(function(n){i.extend(n);""}):t.getCenter&&i.extend(t.getCenter())});i.isEmpty()||c.getBounds()&&c.getBounds().equals(i)||("maxZoom"in t.todo&&google.maps.event.addListenerOnce(c,"bounds_changed",function(){this.getZoom()>t.todo.maxZoom&&this.setZoom(t.todo.maxZoom)}),c.fitBounds(i));a(t,!0)};this.clear=function(t){if(typeof t.todo=="string"){if(l.clearById(t.todo)||l.objClearById(t.todo)){a(t,!0);return}t.todo={name:t.todo}}t.todo.id?n.each(e(t.todo.id),function(n,t){l.clearById(t)}):l.clear(e(t.todo.name),t.todo.last,t.todo.first,t.todo.tag);a(t,!0)};this.exec=function(t){var i=this;n.each(e(t.todo.func),function(r,f){n.each(i.get(t.todo,!0,t.todo.hasOwnProperty("full")?t.todo.full:!0),function(n,t){f.call(u,t)})});a(t,!0)};this.get=function(i,r,u){var s,f,o=r?i:i.todo;if(r||(u=o.full),typeof o=="string"?(f=l.getById(o,!1,u)||l.objGetById(o),f===!1&&(s=o,o={})):s=o.name,s==="map"&&(f=c),f||(f=[],o.id?(n.each(e(o.id),function(n,t){f.push(l.getById(t,!1,u)||l.objGetById(t))}),n.isArray(o.id)||(f=f[0])):(n.each(s?e(s):[t],function(t,i){var r;o.first?(r=l.get(i,!1,o.tag,u),r&&f.push(r)):o.all?n.each(l.all(i,o.tag,u),function(n,t){f.push(t)}):(r=l.get(i,!0,o.tag,u),r&&f.push(r))}),o.all||n.isArray(s)||(f=f[0]))),f=n.isArray(f)||!o.all?f:[f],r)return f;a(i,f)};this.getdistance=function(n){var t;for(n.opts.origins=e(n.opts.origins),t=0;t<n.opts.origins.length;t++)n.opts.origins[t]=i(n.opts.origins[t],!0);for(n.opts.destinations=e(n.opts.destinations),t=0;t<n.opts.destinations.length;t++)n.opts.destinations[t]=i(n.opts.destinations[t],!0);ht().getDistanceMatrix(n.opts,function(t,i){d(n,i===google.maps.DistanceMatrixStatus.OK?t:!1,i);v.ack()})};this.trigger=function(t){if(typeof t.todo=="string")google.maps.event.trigger(c,t.todo);else{var i=[c,t.todo.eventName];t.todo.var_args&&n.each(t.todo.var_args,function(n,t){i.push(t)});google.maps.event.trigger.apply(google.maps.event,i)}d(t);v.ack()}}function vt(n){var t;if(!1||!n.hasOwnProperty("get"))return!1;for(t in n)if(t!=="get")return!1;return!n.get.hasOwnProperty("callback")}var r,a=0,u={},w=new it;n.fn.gmap3=function(){var i,t=[],u=!0,r=[];for(d(),i=0;i<arguments.length;i++)arguments[i]&&t.push(arguments[i]);return(t.length||t.push("map"),n.each(this,function(){var f=n(this),i=f.data("gmap3");u=!1;i||(i=new at(f),f.data("gmap3",i));t.length===1&&(t[0]==="get"||vt(t[0]))?r.push(i.get(t[0]==="get"?"map":t[0].get,!0)):i._plan(t)}),r.length)?r.length===1?r[0]:r:this}})(jQuery);
//# sourceMappingURL=gmap3.min.js.map
